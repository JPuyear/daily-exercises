<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Josh Puyear">

<title>Daily Exercise 17</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="17-exercise_files/libs/clipboard/clipboard.min.js"></script>
<script src="17-exercise_files/libs/quarto-html/quarto.js"></script>
<script src="17-exercise_files/libs/quarto-html/popper.min.js"></script>
<script src="17-exercise_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="17-exercise_files/libs/quarto-html/anchor.min.js"></script>
<link href="17-exercise_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="17-exercise_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="17-exercise_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="17-exercise_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="17-exercise_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="17-exercise_files/libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">

<script src="17-exercise_files/libs/tabwid-1.1.3/tabwid.js"></script>



</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Daily Exercise 17</h1>
<p class="subtitle lead">Intro to Machine Learning</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Josh Puyear <a href="mailto:jpuyear@colostate.edu" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p>Machine learning (ML) is widely used in environmental science for tasks such as land cover classification, climate modeling, and forested distribution prediction. This lecture explores five common ML model specifications the tidymodels framework in R, applied to the forested dataset.</p>
<ol type="1">
<li>Linear Regression</li>
<li>Logistic Regression</li>
<li>Trees</li>
</ol>
<ul>
<li>Decision Tree</li>
<li>Random Forest</li>
<li>Boost</li>
</ul>
<ol start="4" type="1">
<li>Support Vector Machines</li>
<li>Neural Nets</li>
</ol>
<section id="classification-vs.-prediction" class="level2">
<h2 class="anchored" data-anchor-id="classification-vs.-prediction">Classification vs.&nbsp;Prediction</h2>
<p>Most machine learning applications in environmental science serve different purposes (modes):</p>
<ol type="1">
<li>Classification Models â†’ Categorize features into predefined classes.</li>
</ol>
<section id="examples" class="level3">
<h3 class="anchored" data-anchor-id="examples">Examples:</h3>
<p>âœ… Land Cover Classification (Forest, Urban, Water, Agriculture) âœ… Flood Risk Assessment (High, Medium, Low) âœ… Drought Severity Levels (No Drought, Moderate, Severe) âœ… Wildfire Prediction (Fire vs.&nbsp;No Fire) âœ… forested Identification (Bird forested, Plant Types)</p>
</section>
</section>
<section id="prediction-models-forecast-numerical-environmental-variables-based-on-past-trends" class="level1">
<h1>Prediction Models â†’ Forecast numerical environmental variables based on past trends</h1>
<p>Common Algorithms: <em>Decision Trees</em> Random Forest <em>Support Vector Machines (SVM)</em> Neural Networks (for remote sensing &amp; image analysis) *K-Nearest Neighbors (KNN)</p>
<section id="examples-1" class="level3">
<h3 class="anchored" data-anchor-id="examples-1">Examples:</h3>
<p>ğŸ“ˆ Streamflow Forecasting (Predict river discharge over time) ğŸŒ¡ï¸ Temperature Projections (Future temperature changes under climate scenarios) â˜” Precipitation Forecasting (Rainfall estimates for flood preparedness) ğŸ“Š Air Quality Index Prediction (Forecast pollution levels)</p>
<p>Common Algorithms: <em>Linear &amp; Multiple Regression</em> Random Forest Regression *Long Short-Term Memory (LSTM) Neural Networks (for time series forecasting)</p>
</section>
<section id="choosing-the-right-model" class="level2">
<h2 class="anchored" data-anchor-id="choosing-the-right-model">Choosing the Right Model</h2>
<ul>
<li>Use classification if: You need to categorize environmental states (e.g., classifying land use changes).</li>
<li>Use prediction if: You need to forecast environmental conditions (e.g., predicting flood levels)</li>
<li>Use hybrid approaches if: You need to classify and predict (e.g., classifying drought severity and then predicting future water availability).</li>
</ul>
</section>
<section id="model-selection-considerations" class="level2">
<h2 class="anchored" data-anchor-id="model-selection-considerations">Model Selection Considerations</h2>
<p>Choosing an ML algorithm (model) depends on:</p>
<ul>
<li>Dataset Size: e.g.&nbsp;Large datasets benefit from ensemble methods like Random Forest and XGBoost.</li>
<li>Feature Complexity: e.g.&nbsp;SVM works well for high-dimensional data.</li>
<li>Interpretability Needs: e.g.&nbsp;Decision trees and LASSO regression provide intuitive insights.</li>
<li>Computation Constraints: e.g.&nbsp;GLM and Decision Trees are efficient compared to XGBoost.</li>
<li>Data: Variance, linearity, diminsionality</li>
</ul>
</section>
</section>
<section id="load-required-libraries-for-modelbuilding" class="level1">
<h1>Load Required Libraries for Modelbuilding</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>â”€â”€ Attaching core tidyverse packages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse 2.0.0 â”€â”€
âœ” dplyr     1.1.4     âœ” readr     2.1.5
âœ” forcats   1.0.0     âœ” stringr   1.5.1
âœ” ggplot2   3.5.2     âœ” tibble    3.2.1
âœ” lubridate 1.9.4     âœ” tidyr     1.3.1
âœ” purrr     1.0.4     
â”€â”€ Conflicts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse_conflicts() â”€â”€
âœ– dplyr::filter() masks stats::filter()
âœ– dplyr::lag()    masks stats::lag()
â„¹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>â”€â”€ Attaching packages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidymodels 1.3.0 â”€â”€
âœ” broom        1.0.7     âœ” rsample      1.2.1
âœ” dials        1.4.0     âœ” tune         1.3.0
âœ” infer        1.0.7     âœ” workflows    1.2.0
âœ” modeldata    1.4.0     âœ” workflowsets 1.1.0
âœ” parsnip      1.3.1     âœ” yardstick    1.3.2
âœ” recipes      1.2.1     
â”€â”€ Conflicts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidymodels_conflicts() â”€â”€
âœ– scales::discard() masks purrr::discard()
âœ– dplyr::filter()   masks stats::filter()
âœ– recipes::fixed()  masks stringr::fixed()
âœ– dplyr::lag()      masks stats::lag()
âœ– yardstick::spec() masks readr::spec()
âœ– recipes::step()   masks stats::step()</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forested)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'flextable'

The following object is masked from 'package:purrr':

    compose</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rsample)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Matrix

Attaching package: 'Matrix'

The following objects are masked from 'package:tidyr':

    expand, pack, unpack

Loaded glmnet 4.1-8</code></pre>
</div>
</div>
</section>
<section id="data-preparation" class="level1">
<h1>Data Preparation</h1>
<p>We will use the forested dataset for classification tasks. The dataset contains information about penguin forested, body measurements, and other environmental factors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>forested_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(forested, <span class="at">strata =</span> tree_no_tree)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>forested_train <span class="ot">&lt;-</span> <span class="fu">training</span>(forested_split)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>forested_test  <span class="ot">&lt;-</span> <span class="fu">testing</span>(forested_split)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>forested_folds <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(forested_train, <span class="at">v =</span> <span class="dv">10</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Feature Engineering: Classification</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>forested_recipe <span class="ot">&lt;-</span> <span class="fu">recipe</span>(forested <span class="sc">~</span> ., <span class="at">data =</span> forested_train)  <span class="sc">|&gt;</span> </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal_predictors</span>())  <span class="sc">|&gt;</span> </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_impute_mean</span>(<span class="fu">all_numeric_predictors</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="machine-learning-specifications-in-tidymodels" class="level1">
<h1>Machine Learning Specifications in tidymodels</h1>
<p>Unified Interface for ML Models</p>
<ul>
<li>The parsnip package is a part of the tidymodels framework</li>
<li>It provides a consistent interface for specifying models through specifications</li>
<li>The combination of a specification, mode, and engine is called a model</li>
<li>Lets look at the parsnip documentation!</li>
</ul>
<section id="what-are-hyperparameters" class="level2">
<h2 class="anchored" data-anchor-id="what-are-hyperparameters">What are hyperparameters?</h2>
<ul>
<li>Hyperparameters are settings that control the learning process of a model.</li>
<li>They are set before training and affect the modelâ€™s performance.</li>
<li>Hyperparameters can be tuned to optimize the modelâ€™s predictive power.</li>
<li>More on model tuning next week!</li>
</ul>
</section>
<section id="linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="linear-regression">1. Linear Regression</h2>
<p>Linear regression is a fundamental statistical method used for modeling the relationship between a dependent variable and one or more independent variables. It is widely used in environmental science for tasks such as predicting forested distribution, estimating climate variables, and modeling ecosystem dynamics.</p>
<section id="components-of-linear-regression" class="level4">
<h4 class="anchored" data-anchor-id="components-of-linear-regression">Components of Linear Regression</h4>
<ul>
<li>Dependent Variable (Y): The variable to be predicted.</li>
<li>Independent Variables (X): Features that influence the dependent variable.</li>
<li>Regression Line: Represents the relationship between X and Y.</li>
<li>Residuals: Differences between predicted and actual values.</li>
</ul>
</section>
<section id="linear-regression-in-tidymodels" class="level4">
<h4 class="anchored" data-anchor-id="linear-regression-in-tidymodels">Linear regression in tidymodels</h4>
<p>Specification</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">linear_reg</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear Regression Model Specification (regression)

Computational engine: lm </code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear Regression Model Specification (regression)</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Computational engine: lm</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Engines and modes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">show_engines</span>(<span class="st">"linear_reg"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">specification =</span> <span class="st">"linear_reg"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-c317e40c{}.cl-c30e6134{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-c3124880{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c3126aea{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c3126af4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c3126afe{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-c317e40c"><thead><tr style="overflow-wrap:break-word;"><th class="cl-c3126aea"><p class="cl-c3124880"><span class="cl-c30e6134">engine</span></p></th><th class="cl-c3126aea"><p class="cl-c3124880"><span class="cl-c30e6134">mode</span></p></th><th class="cl-c3126aea"><p class="cl-c3124880"><span class="cl-c30e6134">specification</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-c3126af4"><p class="cl-c3124880"><span class="cl-c30e6134">lm</span></p></td><td class="cl-c3126af4"><p class="cl-c3124880"><span class="cl-c30e6134">regression</span></p></td><td class="cl-c3126af4"><p class="cl-c3124880"><span class="cl-c30e6134">linear_reg</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c3126af4"><p class="cl-c3124880"><span class="cl-c30e6134">glm</span></p></td><td class="cl-c3126af4"><p class="cl-c3124880"><span class="cl-c30e6134">regression</span></p></td><td class="cl-c3126af4"><p class="cl-c3124880"><span class="cl-c30e6134">linear_reg</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c3126af4"><p class="cl-c3124880"><span class="cl-c30e6134">glmnet</span></p></td><td class="cl-c3126af4"><p class="cl-c3124880"><span class="cl-c30e6134">regression</span></p></td><td class="cl-c3126af4"><p class="cl-c3124880"><span class="cl-c30e6134">linear_reg</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c3126af4"><p class="cl-c3124880"><span class="cl-c30e6134">stan</span></p></td><td class="cl-c3126af4"><p class="cl-c3124880"><span class="cl-c30e6134">regression</span></p></td><td class="cl-c3126af4"><p class="cl-c3124880"><span class="cl-c30e6134">linear_reg</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c3126af4"><p class="cl-c3124880"><span class="cl-c30e6134">spark</span></p></td><td class="cl-c3126af4"><p class="cl-c3124880"><span class="cl-c30e6134">regression</span></p></td><td class="cl-c3126af4"><p class="cl-c3124880"><span class="cl-c30e6134">linear_reg</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c3126af4"><p class="cl-c3124880"><span class="cl-c30e6134">keras</span></p></td><td class="cl-c3126af4"><p class="cl-c3124880"><span class="cl-c30e6134">regression</span></p></td><td class="cl-c3126af4"><p class="cl-c3124880"><span class="cl-c30e6134">linear_reg</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c3126af4"><p class="cl-c3124880"><span class="cl-c30e6134">brulee</span></p></td><td class="cl-c3126af4"><p class="cl-c3124880"><span class="cl-c30e6134">regression</span></p></td><td class="cl-c3126af4"><p class="cl-c3124880"><span class="cl-c30e6134">linear_reg</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c3126afe"><p class="cl-c3124880"><span class="cl-c30e6134">quantreg</span></p></td><td class="cl-c3126afe"><p class="cl-c3124880"><span class="cl-c30e6134">quantile regression</span></p></td><td class="cl-c3126afe"><p class="cl-c3124880"><span class="cl-c30e6134">linear_reg</span></p></td></tr></tbody></table></div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>lm_mod <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>(<span class="at">mode =</span> <span class="st">"regression"</span>, <span class="at">engine =</span> <span class="st">"lm"</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">workflow</span>() <span class="sc">|&gt;</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_formula</span>(elevation <span class="sc">~</span> .) <span class="sc">|&gt;</span> </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(lm_mod) <span class="sc">|&gt;</span> </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(<span class="at">resample =</span> forested_folds) <span class="sc">|&gt;</span> </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 Ã— 6
  .metric .estimator   mean     n  std_err .config             
  &lt;chr&gt;   &lt;chr&gt;       &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt; &lt;chr&gt;               
1 rmse    standard   82.6      10 1.23     Preprocessor1_Model1
2 rsq     standard    0.971    10 0.000733 Preprocessor1_Model1</code></pre>
</div>
</div>
</section>
</section>
<section id="logistic-regression" class="level2">
<h2 class="anchored" data-anchor-id="logistic-regression">2. Logistic Regression</h2>
<p>Logistic Regression is widely used in machine learning due to its:</p>
<ul>
<li>Simplicity: Easy to implement and interpret.</li>
<li>Efficiency: Computationally inexpensive, even on large datasets.</li>
<li>Probabilistic Predictions: Outputs probabilities instead of hard classifications.</li>
<li>Regularization Support: Extensions like L1 (Lasso) and L2 (Ridge) help prevent overfitting.</li>
</ul>
<section id="components-of-logistic-regression" class="level4">
<h4 class="anchored" data-anchor-id="components-of-logistic-regression">Components of Logistic Regression</h4>
<ul>
<li>Sigmoid Function: Converts linear outputs into probabilities between 0 and 1.</li>
<li>Decision Boundary: A threshold (often 0.5) determines classification.</li>
<li>Log-Loss (Binary Cross-Entropy): Measures the error between predicted probabilities and actual labels.</li>
<li>Regularization (L1 and L2): Helps in feature selection and prevents overfitting. I would like to understand overfitting better- is this when the model makes more predictions than there are points?</li>
</ul>
</section>
<section id="variants-of-logistic-regression" class="level4">
<h4 class="anchored" data-anchor-id="variants-of-logistic-regression">Variants of Logistic Regression</h4>
<ul>
<li>Binary Logistic Regression: Used when the target variable has two classes (e.g., forested vs.&nbsp;not).</li>
<li>Multinomial Logistic Regression: Extends logistic regression to multiple classes without assuming ordering.</li>
<li>Ordinal Logistic Regression: Handles multi-class classification where order matters (e.g., rating scales).</li>
</ul>
</section>
<section id="building-a-logistic-regression-model" class="level4">
<h4 class="anchored" data-anchor-id="building-a-logistic-regression-model">Building a Logistic Regression Model</h4>
<p>Constructing a Logistic Regression Model involves: 1. Defining feature (X) and target variable (y). 2. Applying the sigmoid function to map predictions to probabilities. 3. Using a loss function (log-loss) to optimize model weights. 4. Updating weights iteratively via gradient descent.</p>
<p>Hyperparameters in Logistic Regression: * penalty: Type of regularization (L1, L2, or none). * mixture: A number between zero and one giving the proportion of L1 regularization (i.e.&nbsp;lasso) in the model</p>
</section>
<section id="advantages-logreg" class="level4">
<h4 class="anchored" data-anchor-id="advantages-logreg">Advantages logreg</h4>
<p>Advantages: * Simple and interpretable. * Efficient on large datasets. * Outputs probabilities for uncertainty estimation. * Works well when data is linearly separable.</p>
</section>
<section id="disadvantages-logreg" class="level4">
<h4 class="anchored" data-anchor-id="disadvantages-logreg">Disadvantages logreg</h4>
<ul>
<li>Assumes a linear decision boundary.</li>
<li>Sensitive to outliers.</li>
<li>Can underperform on complex, non-linear data.</li>
</ul>
</section>
<section id="logistic-regression-in-tidymodels" class="level4">
<h4 class="anchored" data-anchor-id="logistic-regression-in-tidymodels">Logistic Regression in tidymodels</h4>
<p>Specification</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logistic_reg</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Logistic Regression Model Specification (classification)

Computational engine: glm </code></pre>
</div>
</div>
<p>engines and modes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">show_engines</span>(<span class="st">'logistic_reg'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">specification =</span> <span class="st">"logistic_reg"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-c398e9c6{}.cl-c390bd50{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-c393d634{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c393f1dc{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c393f1f0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c393f1f1{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-c398e9c6"><thead><tr style="overflow-wrap:break-word;"><th class="cl-c393f1dc"><p class="cl-c393d634"><span class="cl-c390bd50">engine</span></p></th><th class="cl-c393f1dc"><p class="cl-c393d634"><span class="cl-c390bd50">mode</span></p></th><th class="cl-c393f1dc"><p class="cl-c393d634"><span class="cl-c390bd50">specification</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-c393f1f0"><p class="cl-c393d634"><span class="cl-c390bd50">glm</span></p></td><td class="cl-c393f1f0"><p class="cl-c393d634"><span class="cl-c390bd50">classification</span></p></td><td class="cl-c393f1f0"><p class="cl-c393d634"><span class="cl-c390bd50">logistic_reg</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c393f1f0"><p class="cl-c393d634"><span class="cl-c390bd50">glmnet</span></p></td><td class="cl-c393f1f0"><p class="cl-c393d634"><span class="cl-c390bd50">classification</span></p></td><td class="cl-c393f1f0"><p class="cl-c393d634"><span class="cl-c390bd50">logistic_reg</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c393f1f0"><p class="cl-c393d634"><span class="cl-c390bd50">LiblineaR</span></p></td><td class="cl-c393f1f0"><p class="cl-c393d634"><span class="cl-c390bd50">classification</span></p></td><td class="cl-c393f1f0"><p class="cl-c393d634"><span class="cl-c390bd50">logistic_reg</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c393f1f0"><p class="cl-c393d634"><span class="cl-c390bd50">spark</span></p></td><td class="cl-c393f1f0"><p class="cl-c393d634"><span class="cl-c390bd50">classification</span></p></td><td class="cl-c393f1f0"><p class="cl-c393d634"><span class="cl-c390bd50">logistic_reg</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c393f1f0"><p class="cl-c393d634"><span class="cl-c390bd50">keras</span></p></td><td class="cl-c393f1f0"><p class="cl-c393d634"><span class="cl-c390bd50">classification</span></p></td><td class="cl-c393f1f0"><p class="cl-c393d634"><span class="cl-c390bd50">logistic_reg</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c393f1f0"><p class="cl-c393d634"><span class="cl-c390bd50">stan</span></p></td><td class="cl-c393f1f0"><p class="cl-c393d634"><span class="cl-c390bd50">classification</span></p></td><td class="cl-c393f1f0"><p class="cl-c393d634"><span class="cl-c390bd50">logistic_reg</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c393f1f1"><p class="cl-c393d634"><span class="cl-c390bd50">brulee</span></p></td><td class="cl-c393f1f1"><p class="cl-c393d634"><span class="cl-c390bd50">classification</span></p></td><td class="cl-c393f1f1"><p class="cl-c393d634"><span class="cl-c390bd50">logistic_reg</span></p></td></tr></tbody></table></div>
</div>
</div>
</section>
<section id="example-logistic-regression" class="level4">
<h4 class="anchored" data-anchor-id="example-logistic-regression">Example logistic regression</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>log_model <span class="ot">&lt;-</span> <span class="fu">logistic_reg</span>(<span class="at">penalty =</span> .<span class="dv">01</span>) <span class="sc">|&gt;</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"glmnet"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">'classification'</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">workflow</span>() <span class="sc">|&gt;</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(forested_recipe) <span class="sc">|&gt;</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(log_model) <span class="sc">|&gt;</span> </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(<span class="at">resample =</span> forested_folds) <span class="sc">|&gt;</span> </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 Ã— 6
  .metric     .estimator   mean     n std_err .config             
  &lt;chr&gt;       &lt;chr&gt;       &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
1 accuracy    binary     0.893     10 0.00429 Preprocessor1_Model1
2 brier_class binary     0.0786    10 0.00330 Preprocessor1_Model1
3 roc_auc     binary     0.958     10 0.00304 Preprocessor1_Model1</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>Logistic Regression is a fundamental classification algorithm known for its simplicity and efficiency. It serves as a strong baseline model and is widely applied in domains like medical diagnosis, credit scoring, and fraud detection. With proper tuning and regularization, it remains a powerful tool in predictive modeling.</p>
<p>Credit score based on what factors? decision made with logreg you literal score?</p>
<section id="decision-trees" class="level2">
<h2 class="anchored" data-anchor-id="decision-trees">3. Decision Trees</h2>
<p>A Decision Tree is a flowchart-like structure used for decision-making and predictive modeling. It consists of nodes representing decisions, branches indicating possible outcomes, and leaf nodes that represent final classifications or numerical outputs. Decision Trees are widely used in both classification and regression tasks.</p>
<section id="why-use-decision-trees" class="level4">
<h4 class="anchored" data-anchor-id="why-use-decision-trees">Why Use Decision Trees?</h4>
<p>Decision Trees are popular due to their: - <strong>Simplicity and Interpretability</strong>: Easy to understand and visualize. - <strong>Non-Linearity Handling</strong>: Can capture complex relationships in data. - <strong>Feature Importance</strong>: Helps in identifying the most influential features. - <strong>Minimal Data Preprocessing</strong>: Requires little to no feature scaling.</p>
</section>
<section id="components-of-a-decision-tree" class="level3">
<h3 class="anchored" data-anchor-id="components-of-a-decision-tree">Components of a Decision Tree</h3>
<ul>
<li>Root Node: The starting point representing the entire dataset.</li>
<li>Decision Nodes: Intermediate nodes where a dataset is split based on a feature.</li>
<li>Splitting: The process of dividing a node into sub-nodes based on a feature value.</li>
<li>Pruning: The process of removing unnecessary branches to avoid overfitting.</li>
<li>Leaf Nodes: The terminal nodes that provide the final output (class label or numerical prediction).</li>
</ul>
</section>
<section id="building-a-decision-tree" class="level3">
<h3 class="anchored" data-anchor-id="building-a-decision-tree">Building a Decision Tree</h3>
<section id="constructing-a-decision-tree-involves" class="level4">
<h4 class="anchored" data-anchor-id="constructing-a-decision-tree-involves">Constructing a Decision Tree involves:</h4>
<ul>
<li>Selecting the best feature(s) to split the data.</li>
<li>Splitting the data into subsets.</li>
<li>Repeating this process recursively until stopping criteria (e.g., depth, minimum samples per leaf) are met.</li>
<li>Pruning the tree if necessary to reduce overfitting.</li>
</ul>
</section>
<section id="splitting-criteria" class="level4">
<h4 class="anchored" data-anchor-id="splitting-criteria">Splitting Criteria</h4>
<p>Several criteria can be used to determine the best split: - Gini Impurity: Measures the impurity of a node, used in Classification and Regression Trees (CART). - Entropy (Information Gain): Measures the randomness in a dataset. - Mean Squared Error (MSE): Used for regression trees to minimize variance within nodes.</p>
</section>
<section id="hyperparameters-in-decision-trees" class="level4">
<h4 class="anchored" data-anchor-id="hyperparameters-in-decision-trees">Hyperparameters in Decision Trees</h4>
<p>Key hyperparameters include: - cost_complexity: complexity parameter for pruning - tree_depth: maximum depth of the tree - min_n: minimum number of observations in a node</p>
<p>The hyperparameters tell the model a cutoff point to stop making iterations</p>
<p>DT Advantages: * Easy to interpret and explain. * Can handle both numerical and categorical data. * Requires minimal data preparation. * Works well with missing values.</p>
<p>DT Disadvantages: * Prone to overfitting, especially on small datasets. * Can be unstable; small changes in data can lead to drastically different splits. * Biased towards features with more levels.</p>
</section>
</section>
<section id="decision-tree-using-tidymodels" class="level3">
<h3 class="anchored" data-anchor-id="decision-tree-using-tidymodels">Decision Tree using tidymodels</h3>
<p>Specification</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">decision_tree</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Decision Tree Model Specification (unknown mode)

Computational engine: rpart </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">show_engines</span>(<span class="st">'decision_tree'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">specification =</span> <span class="st">"decision_tree"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-c5e7722e{}.cl-c5df7b5a{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-c5e2c670{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c5e2e9c0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c5e2e9de{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c5e2e9df{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-c5e7722e"><thead><tr style="overflow-wrap:break-word;"><th class="cl-c5e2e9c0"><p class="cl-c5e2c670"><span class="cl-c5df7b5a">engine</span></p></th><th class="cl-c5e2e9c0"><p class="cl-c5e2c670"><span class="cl-c5df7b5a">mode</span></p></th><th class="cl-c5e2e9c0"><p class="cl-c5e2c670"><span class="cl-c5df7b5a">specification</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-c5e2e9de"><p class="cl-c5e2c670"><span class="cl-c5df7b5a">rpart</span></p></td><td class="cl-c5e2e9de"><p class="cl-c5e2c670"><span class="cl-c5df7b5a">classification</span></p></td><td class="cl-c5e2e9de"><p class="cl-c5e2c670"><span class="cl-c5df7b5a">decision_tree</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c5e2e9de"><p class="cl-c5e2c670"><span class="cl-c5df7b5a">rpart</span></p></td><td class="cl-c5e2e9de"><p class="cl-c5e2c670"><span class="cl-c5df7b5a">regression</span></p></td><td class="cl-c5e2e9de"><p class="cl-c5e2c670"><span class="cl-c5df7b5a">decision_tree</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c5e2e9de"><p class="cl-c5e2c670"><span class="cl-c5df7b5a">C5.0</span></p></td><td class="cl-c5e2e9de"><p class="cl-c5e2c670"><span class="cl-c5df7b5a">classification</span></p></td><td class="cl-c5e2e9de"><p class="cl-c5e2c670"><span class="cl-c5df7b5a">decision_tree</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c5e2e9de"><p class="cl-c5e2c670"><span class="cl-c5df7b5a">spark</span></p></td><td class="cl-c5e2e9de"><p class="cl-c5e2c670"><span class="cl-c5df7b5a">classification</span></p></td><td class="cl-c5e2e9de"><p class="cl-c5e2c670"><span class="cl-c5df7b5a">decision_tree</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c5e2e9df"><p class="cl-c5e2c670"><span class="cl-c5df7b5a">spark</span></p></td><td class="cl-c5e2e9df"><p class="cl-c5e2c670"><span class="cl-c5df7b5a">regression</span></p></td><td class="cl-c5e2e9df"><p class="cl-c5e2c670"><span class="cl-c5df7b5a">decision_tree</span></p></td></tr></tbody></table></div>
</div>
</div>
<section id="dt-example" class="level4">
<h4 class="anchored" data-anchor-id="dt-example">DT Example</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>dt_model <span class="ot">&lt;-</span> <span class="fu">decision_tree</span>(<span class="at">tree_depth =</span> <span class="dv">10</span>, <span class="at">min_n =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"rpart"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">'classification'</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">workflow</span>() <span class="sc">|&gt;</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(forested_recipe) <span class="sc">|&gt;</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(dt_model) <span class="sc">|&gt;</span> </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(<span class="at">resample =</span> forested_folds) <span class="sc">|&gt;</span> </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 Ã— 6
  .metric     .estimator   mean     n std_err .config             
  &lt;chr&gt;       &lt;chr&gt;       &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
1 accuracy    binary     0.891     10 0.00361 Preprocessor1_Model1
2 brier_class binary     0.0911    10 0.00329 Preprocessor1_Model1
3 roc_auc     binary     0.911     10 0.00526 Preprocessor1_Model1</code></pre>
</div>
</div>
</section>
<section id="conclusion-1" class="level4">
<h4 class="anchored" data-anchor-id="conclusion-1">Conclusion</h4>
<p>Decision Trees are a powerful and interpretable tool for both classification and regression problems. While they have limitations, techniques like pruning and ensemble methods (e.g., Random Forests) can help mitigate their weaknesses. Understanding Decision Trees within the tidymodels framework makes them accessible for practical applications in environmental science.</p>
</section>
</section>
</section>
<section id="random-forest" class="level2">
<h2 class="anchored" data-anchor-id="random-forest">4. Random Forest</h2>
<p>Random Forests provide an ensemble learning method that constructs multiple decision trees and aggregates their predictions to improve accuracy and reduce overfitting. It is used for both classification and regression tasks.</p>
<section id="why-use-random-forest" class="level3">
<h3 class="anchored" data-anchor-id="why-use-random-forest">Why Use Random Forest?</h3>
<p>Random Forest offers several advantages: - <strong>Higher Accuracy</strong>: By combining multiple decision trees, it reduces variance and improves predictive performance. - <strong>Robustness to Overfitting</strong>: By averaging multiple trees, it mitigates the risk of overfitting. - <strong>Feature Importance Analysis</strong>: Helps identify the most influential features. - <strong>Handles Missing Data</strong>: Can work well with incomplete datasets.</p>
</section>
<section id="components-of-a-random-forest" class="level3">
<h3 class="anchored" data-anchor-id="components-of-a-random-forest">Components of a Random Forest</h3>
<ul>
<li>Multiple Decision Trees: The fundamental building blocks.</li>
<li>Bootstrap Sampling: Randomly selects subsets of data to train each tree.</li>
<li>Feature Subsetting: Uses a random subset of features at each split to improve diversity among trees.</li>
<li>Aggregation (Bagging): Combines the outputs of individual trees through voting (classification) or averaging (regression).</li>
</ul>
</section>
<section id="building-a-random-forest" class="level3">
<h3 class="anchored" data-anchor-id="building-a-random-forest">Building a Random Forest</h3>
<section id="constructing-a-random-forest-involves" class="level4">
<h4 class="anchored" data-anchor-id="constructing-a-random-forest-involves">Constructing a Random Forest involves:</h4>
<ol type="1">
<li>Creating multiple bootstrap samples from the dataset.</li>
<li>Training a decision tree on each bootstrap sample using a random subset of features.</li>
<li>Aggregating predictions from all trees to produce the final output.</li>
</ol>
</section>
<section id="hyperparameters-in-random-forest" class="level4">
<h4 class="anchored" data-anchor-id="hyperparameters-in-random-forest">Hyperparameters in Random Forest:</h4>
<ul>
<li>Number of Trees (ntree): Determines how many trees are included in the forest.</li>
<li>Maximum Depth (max_depth): Limits the depth of individual trees to prevent overfitting.</li>
<li>Minimum Samples per Leaf (min_n): Specifies the minimum number of observations required in a leaf node.</li>
<li>Number of Features (mtry): Controls how many features are randomly selected at each split.</li>
</ul>
</section>
</section>
<section id="advantages-and-disadvantages" class="level3">
<h3 class="anchored" data-anchor-id="advantages-and-disadvantages">Advantages and Disadvantages</h3>
<section id="advantages" class="level4">
<h4 class="anchored" data-anchor-id="advantages">Advantages:</h4>
<ul>
<li>Handles large datasets with high-dimensional feature spaces.</li>
<li>Reduces overfitting by averaging multiple decision trees.</li>
<li>Works well with both categorical and numerical data.</li>
<li>Provides built-in feature selection.</li>
</ul>
</section>
<section id="disadvantages" class="level4">
<h4 class="anchored" data-anchor-id="disadvantages">Disadvantages:</h4>
<ul>
<li>Requires more computational resources than a single decision tree.</li>
<li>Less interpretable than a single decision tree.</li>
<li>Can be slower to make predictions due to ensemble averaging.</li>
</ul>
</section>
</section>
<section id="random-forest-implementation-using-tidymodels" class="level3">
<h3 class="anchored" data-anchor-id="random-forest-implementation-using-tidymodels">Random Forest Implementation using Tidymodels</h3>
<p>Specification</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rand_forest</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Random Forest Model Specification (unknown mode)

Computational engine: ranger </code></pre>
</div>
</div>
<p>engines and nodes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">show_engines</span>(<span class="st">'rand_forest'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">specification =</span> <span class="st">"rand_forest"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-c761cfaa{}.cl-c7586f32{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-c75bca1a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c75beb9e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c75bebb2{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c75bebbc{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-c761cfaa"><thead><tr style="overflow-wrap:break-word;"><th class="cl-c75beb9e"><p class="cl-c75bca1a"><span class="cl-c7586f32">engine</span></p></th><th class="cl-c75beb9e"><p class="cl-c75bca1a"><span class="cl-c7586f32">mode</span></p></th><th class="cl-c75beb9e"><p class="cl-c75bca1a"><span class="cl-c7586f32">specification</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-c75bebb2"><p class="cl-c75bca1a"><span class="cl-c7586f32">ranger</span></p></td><td class="cl-c75bebb2"><p class="cl-c75bca1a"><span class="cl-c7586f32">classification</span></p></td><td class="cl-c75bebb2"><p class="cl-c75bca1a"><span class="cl-c7586f32">rand_forest</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c75bebb2"><p class="cl-c75bca1a"><span class="cl-c7586f32">ranger</span></p></td><td class="cl-c75bebb2"><p class="cl-c75bca1a"><span class="cl-c7586f32">regression</span></p></td><td class="cl-c75bebb2"><p class="cl-c75bca1a"><span class="cl-c7586f32">rand_forest</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c75bebb2"><p class="cl-c75bca1a"><span class="cl-c7586f32">randomForest</span></p></td><td class="cl-c75bebb2"><p class="cl-c75bca1a"><span class="cl-c7586f32">classification</span></p></td><td class="cl-c75bebb2"><p class="cl-c75bca1a"><span class="cl-c7586f32">rand_forest</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c75bebb2"><p class="cl-c75bca1a"><span class="cl-c7586f32">randomForest</span></p></td><td class="cl-c75bebb2"><p class="cl-c75bca1a"><span class="cl-c7586f32">regression</span></p></td><td class="cl-c75bebb2"><p class="cl-c75bca1a"><span class="cl-c7586f32">rand_forest</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c75bebb2"><p class="cl-c75bca1a"><span class="cl-c7586f32">spark</span></p></td><td class="cl-c75bebb2"><p class="cl-c75bca1a"><span class="cl-c7586f32">classification</span></p></td><td class="cl-c75bebb2"><p class="cl-c75bca1a"><span class="cl-c7586f32">rand_forest</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c75bebbc"><p class="cl-c75bca1a"><span class="cl-c7586f32">spark</span></p></td><td class="cl-c75bebbc"><p class="cl-c75bca1a"><span class="cl-c7586f32">regression</span></p></td><td class="cl-c75bebbc"><p class="cl-c75bca1a"><span class="cl-c7586f32">rand_forest</span></p></td></tr></tbody></table></div>
</div>
</div>
<section id="rand-forest-example" class="level4">
<h4 class="anchored" data-anchor-id="rand-forest-example">Rand Forest Example</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a Random Forest model</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>rf_model <span class="ot">&lt;-</span> <span class="fu">rand_forest</span>(<span class="at">trees =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"ranger"</span>, <span class="at">importance =</span> <span class="st">"impurity"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="fu">workflow</span>() <span class="sc">|&gt;</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(forested_recipe) <span class="sc">|&gt;</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(rf_model) <span class="sc">|&gt;</span> </span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(<span class="at">resample =</span> forested_folds) <span class="sc">|&gt;</span> </span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 Ã— 6
  .metric     .estimator   mean     n std_err .config             
  &lt;chr&gt;       &lt;chr&gt;       &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
1 accuracy    binary     0.904     10 0.00398 Preprocessor1_Model1
2 brier_class binary     0.0697    10 0.00285 Preprocessor1_Model1
3 roc_auc     binary     0.962     10 0.00250 Preprocessor1_Model1</code></pre>
</div>
</div>
</section>
<section id="conclusion-2" class="level4">
<h4 class="anchored" data-anchor-id="conclusion-2">Conclusion</h4>
<p>Random Forest is a powerful ensemble learning method that improves upon decision trees by reducing overfitting and increasing accuracy. By leveraging the tidymodels framework in R, it can be effectively applied to various environmental science problems.</p>
</section>
</section>
</section>
<section id="boosting-machines" class="level2">
<h2 class="anchored" data-anchor-id="boosting-machines">5. Boosting Machines</h2>
<p>Boosting is an ensemble learning technique that builds multiple weak models (often decision trees) sequentially, with each model correcting the errors of its predecessor. This iterative process improves predictive accuracy and reduces bias, making boosting one of the most powerful machine learning methods. Popular implementations include Gradient Boosting Machines (GBM), XGBoost (Extreme Gradient Boosting), LightGBM, and CatBoost.</p>
<section id="why-use-boosting-machines" class="level4">
<h4 class="anchored" data-anchor-id="why-use-boosting-machines">Why Use Boosting Machines?</h4>
<p>XGBoost is widely used in machine learning due to its: - <em>High Accuracy</em>: Often outperforms other algorithms in predictive tasks. - <em>Efficiency</em>: Optimized for speed and parallel processing. - <em>Feature Importance</em>: Provides insights into which features influence predictions. - <em>Robustness to Overfitting</em>: Uses regularization techniques to enhance generalization.</p>
</section>
<section id="components-of-gradient-boosting" class="level3">
<h3 class="anchored" data-anchor-id="components-of-gradient-boosting">Components of Gradient Boosting</h3>
<ul>
<li>Weak Learners: Typically small decision trees (stumps).</li>
<li>Gradient Descent Optimization: Each tree corrects the residual errors of the previous trees.</li>
<li>Learning Rate (eta): Controls the contribution of each tree to the final prediction.</li>
<li>Regularization (lambda and alpha): Penalizes complex trees to prevent overfitting.</li>
</ul>
<p>Popular Boosting Algorithms</p>
<ul>
<li>Gradient Boosting Machines (GBM): A general boosting method that minimizes loss using gradient descent.</li>
<li>XGBoost (Extreme Gradient Boosting): An optimized version of GBM that is computationally efficient and includes regularization.</li>
<li>LightGBM: Designed for efficiency on large datasets by using histogram-based learning and reducing memory usage.</li>
<li>CatBoost: Specialized for categorical data, using ordered boosting and permutation techniques to reduce bias.</li>
</ul>
</section>
<section id="building-an-xgboost-model" class="level3">
<h3 class="anchored" data-anchor-id="building-an-xgboost-model">Building an XGBoost Model</h3>
<p>The process involves: 1. Initializing predictions with a simple model (e.g., the mean for regression). 2. Computing the residual errors. 3. Training a new tree to predict these residuals. 4. Updating the predictions by adding a fraction of the new treeâ€™s output. 5. Repeating until a stopping criterion is met (e.g., a maximum number of trees or performance threshold).</p>
</section>
<section id="hyperparameters-in-xgboost" class="level3">
<h3 class="anchored" data-anchor-id="hyperparameters-in-xgboost">Hyperparameters in XGBoost</h3>
<p>Hyperparameters in XGBoost nrounds (Number of Trees): The number of boosting iterations. max_depth: The maximum depth of trees. eta (Learning Rate): Controls how much each tree contributes to the model. gamma: Minimum loss reduction required to split a node. colsample_bytree: Fraction of features to consider for each tree.</p>
<section id="boost-advantages" class="level4">
<h4 class="anchored" data-anchor-id="boost-advantages">Boost Advantages</h4>
<ul>
<li>Handles large datasets efficiently.</li>
<li>Reduces bias and variance compared to single decision trees.</li>
<li>Provides feature impor*tance analysis.</li>
<li>Can be used for both classification and regression.</li>
</ul>
</section>
<section id="boost-disadvantages" class="level4">
<h4 class="anchored" data-anchor-id="boost-disadvantages">Boost Disadvantages</h4>
<ul>
<li>More complex and harder to interpret than a single decision tree.</li>
<li>Requires tuning of hyperparameters for optimal performance.</li>
<li>Can overfit if not properly regularized.</li>
</ul>
</section>
</section>
<section id="boost-implementation-using-tidymodels" class="level3">
<h3 class="anchored" data-anchor-id="boost-implementation-using-tidymodels">Boost Implementation using Tidymodels</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define an XGBoost model</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>b_model <span class="ot">&lt;-</span> <span class="fu">boost_tree</span>() <span class="sc">|&gt;</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"xgboost"</span>) <span class="sc">|&gt;</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="fu">workflow</span>() <span class="sc">|&gt;</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(forested_recipe) <span class="sc">|&gt;</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(b_model) <span class="sc">|&gt;</span> </span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(<span class="at">resample =</span> forested_folds) <span class="sc">|&gt;</span> </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 Ã— 6
  .metric     .estimator   mean     n std_err .config             
  &lt;chr&gt;       &lt;chr&gt;       &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
1 accuracy    binary     0.909     10 0.00461 Preprocessor1_Model1
2 brier_class binary     0.0657    10 0.00259 Preprocessor1_Model1
3 roc_auc     binary     0.969     10 0.00197 Preprocessor1_Model1</code></pre>
</div>
</div>
</section>
<section id="conclusion-3" class="level3">
<h3 class="anchored" data-anchor-id="conclusion-3">Conclusion</h3>
<p>XGBoost is a powerful ensemble learning method that significantly improves predictive accuracy while mitigating overfitting. By leveraging tidymodels in R, environmental scientists can apply XGBoost to various challenges such as climate modeling, pollution forecasting, and disaster risk assessment.</p>
</section>
</section>
<section id="support-vector-machine-svm" class="level2">
<h2 class="anchored" data-anchor-id="support-vector-machine-svm">6. Support Vector Machine (SVM)</h2>
<p>Support Vector Machines (SVM) is a supervised learning algorithm used for classification and regression tasks. It works by finding the optimal hyperplane that best separates data points into different classes.</p>
<section id="why-use-svm" class="level3">
<h3 class="anchored" data-anchor-id="why-use-svm">Why Use SVM?</h3>
<p>SVM is widely used in machine learning due to its: - <strong>Effective for High-Dimensional Data</strong>: Works well with datasets with many features. - <strong>Robustness to Overfitting</strong>: Uses regularization techniques to prevent overfitting. - <strong>Versatility</strong>: Can be applied to linear and non-linear classification tasks using different kernel functions. - <strong>Support for Small Datasets</strong>: Works well when the number of samples is limited.</p>
<section id="components-of-svm" class="level4">
<h4 class="anchored" data-anchor-id="components-of-svm">Components of SVM</h4>
<ul>
<li>Support Vectors: Data points that define the hyperplane.</li>
<li>Margin: The distance between the hyperplane and the nearest support vectors.</li>
<li>Kernel Functions: Transform data to a higher dimension to make it separable.</li>
</ul>
</section>
</section>
<section id="building-an-svm-model" class="level3">
<h3 class="anchored" data-anchor-id="building-an-svm-model">Building an SVM Model</h3>
<ol type="1">
<li>Selecting an appropriate kernel function (linear, polynomial, radial basis function, etc.).</li>
<li>Finding the hyperplane that best separates the data.</li>
<li>Maximizing the margin between the hyperplane and the closest points.</li>
<li>Using a regularization parameter (C) to control trade-offs between a wider margin and misclassifications.</li>
</ol>
<p>Hyperparameters in SVM</p>
<p>Key hyperparameters include: - C (Regularization Parameter): Controls the trade-off between maximizing margin and minimizing classification error. - kernel: Determines the transformation of input space (e.g., linear, radial basis function (RBF), polynomial). - gamma: Controls the influence of individual training</p>
<section id="svm-advantages" class="level4">
<h4 class="anchored" data-anchor-id="svm-advantages">SVM Advantages</h4>
<ul>
<li>Works well with small to medium-sized datasets.</li>
<li>Effective for both linear and non-linear classification.</li>
<li>Handles high-dimensional spaces well.</li>
</ul>
</section>
<section id="svm-disadvantages" class="level4">
<h4 class="anchored" data-anchor-id="svm-disadvantages">SVM Disadvantages</h4>
<ul>
<li>Computationally expensive for large datasets.</li>
<li>Requires careful tuning of hyperparameters.</li>
<li>Not as interpretable as decision trees.</li>
</ul>
</section>
</section>
<section id="svm-implementation-using-tidymodels" class="level3">
<h3 class="anchored" data-anchor-id="svm-implementation-using-tidymodels">SVM Implementation using Tidymodels</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define an SVM model</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kernlab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'kernlab'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dials':

    buffer</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:scales':

    alpha</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    cross</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    alpha</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>svm_model <span class="ot">&lt;-</span> <span class="fu">svm_poly</span>() <span class="sc">|&gt;</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"kernlab"</span>) <span class="sc">|&gt;</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">workflow</span>() <span class="sc">|&gt;</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(forested_recipe) <span class="sc">|&gt;</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(svm_model) <span class="sc">|&gt;</span> </span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(<span class="at">resample =</span> forested_folds) <span class="sc">|&gt;</span> </span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 Ã— 6
  .metric     .estimator   mean     n std_err .config             
  &lt;chr&gt;       &lt;chr&gt;       &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
1 accuracy    binary     0.905     10 0.00421 Preprocessor1_Model1
2 brier_class binary     0.0744    10 0.00320 Preprocessor1_Model1
3 roc_auc     binary     0.956     10 0.00293 Preprocessor1_Model1</code></pre>
</div>
</div>
<section id="conclusion-4" class="level4">
<h4 class="anchored" data-anchor-id="conclusion-4">Conclusion</h4>
<p>Support Vector Machines (SVM) is a powerful algorithm for classification and regression tasks, especially when working with high-dimensional datasets. By leveraging tidymodels in R, environmental scientists can apply SVM to various challenges such as land cover classification, pollution prediction, and climate modeling.</p>
</section>
</section>
</section>
<section id="neural-networks" class="level2">
<h2 class="anchored" data-anchor-id="neural-networks">Neural Networks</h2>
<p>A Neural Network is a computational model inspired by the structure of the human brain. It consists of layers of interconnected neurons that transform input data to learn patterns and make predictions. Neural Networks are widely used for tasks such as image recognition, natural language processing, and time series forecasting.</p>
<section id="why-use-neural-networks" class="level4">
<h4 class="anchored" data-anchor-id="why-use-neural-networks">Why Use Neural Networks?</h4>
<p>Neural Networks are popular due to their: - Ability to Model Complex Patterns: Can capture intricate relationships in data. - Scalability: Performs well with large datasets. - Feature Learning: Automatically extracts relevant features from raw data. - Generalization: Can adapt to different types of data with proper training.</p>
</section>
<section id="components-of-a-neural-network" class="level3">
<h3 class="anchored" data-anchor-id="components-of-a-neural-network">Components of a Neural Network</h3>
<ul>
<li>Neurons: The fundamental units that receive, process, and transmit information.</li>
<li>Input Layer: The initial layer that receives raw data.</li>
<li>Hidden Layers: Intermediate layers where computations occur to learn features.</li>
<li>Output Layer: Produces the final prediction or classification.</li>
<li>Weights &amp; Biases: Parameters that are optimized during training.</li>
<li>Activation Functions: Functions like ReLU, Sigmoid, and Softmax that introduce non-linearity.</li>
</ul>
</section>
<section id="training-a-neural-network" class="level3">
<h3 class="anchored" data-anchor-id="training-a-neural-network">Training a Neural Network</h3>
<p>The training process involves: <em>Forward Propagation: Inputs pass through the network, producing an output.</em> Loss Calculation: The difference between predicted and actual values is measured. * Backpropagation: Errors are propagated backward to update weights. * Optimization: Gradient descent (or its variants) adjusts weights to minimize loss. * Iteration: The process repeats over multiple epochs until convergence.</p>
<p>Hyperparameters in Neural Networks * hidden_units: Number of neurons in hidden layers. * penalty: Regularization term to prevent overfitting. * dropout: Fraction of neurons randomly dropped during training. * epochs: Number of training iterations. * activation: Activation function for neurons (e.g., ReLU, Sigmoid). * learn_rate: Step size for weight updates.</p>
<section id="nn-advantages" class="level4">
<h4 class="anchored" data-anchor-id="nn-advantages">NN Advantages</h4>
<ul>
<li>Can model complex, non-linear relationships.</li>
<li>Works well with high-dimensional data.</li>
<li>Automatically extracts features from data.</li>
</ul>
</section>
<section id="nn-disadvantages" class="level4">
<h4 class="anchored" data-anchor-id="nn-disadvantages">NN Disadvantages</h4>
<ul>
<li>Requires large datasets for effective training.</li>
<li>Computationally expensive.</li>
<li>Difficult to interpret compared to simpler models like Decision Trees.</li>
</ul>
</section>
<section id="varients-of-neural-networks" class="level4">
<h4 class="anchored" data-anchor-id="varients-of-neural-networks">Varients of Neural Networks</h4>
<ul>
<li>mlp() â†’ Generic MLP model (uses â€œnnetâ€, â€œkerasâ€, or â€œbruleeâ€ as an engine).</li>
<li>bag_mlp() â†’ Bagged MLP model using â€œnnetâ€ (reduces variance).</li>
<li>brulee::mlp() â†’ MLP model using torch via brulee (more scalable and flexible).</li>
</ul>
</section>
</section>
<section id="neural-network-implementation" class="level3">
<h3 class="anchored" data-anchor-id="neural-network-implementation">Neural Network Implementation</h3>
<p>mlp() defines a multilayer perceptron model (a.k.a. a single layer, feed-forward neural network). This function can fit classification and regression models.</p>
<p>Specification</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mlp</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Single Layer Neural Network Model Specification (unknown mode)

Computational engine: nnet </code></pre>
</div>
</div>
<p>engines and nodes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">show_engines</span>(<span class="st">"mlp"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">specification =</span> <span class="st">"mlp"</span>) <span class="sc">|&gt;</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-d5ab82cc{}.cl-d5a3616e{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-d5a69d70{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-d5a6c9d0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d5a6c9e4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d5a6c9e5{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-d5ab82cc"><thead><tr style="overflow-wrap:break-word;"><th class="cl-d5a6c9d0"><p class="cl-d5a69d70"><span class="cl-d5a3616e">engine</span></p></th><th class="cl-d5a6c9d0"><p class="cl-d5a69d70"><span class="cl-d5a3616e">mode</span></p></th><th class="cl-d5a6c9d0"><p class="cl-d5a69d70"><span class="cl-d5a3616e">specification</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-d5a6c9e4"><p class="cl-d5a69d70"><span class="cl-d5a3616e">keras</span></p></td><td class="cl-d5a6c9e4"><p class="cl-d5a69d70"><span class="cl-d5a3616e">classification</span></p></td><td class="cl-d5a6c9e4"><p class="cl-d5a69d70"><span class="cl-d5a3616e">mlp</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d5a6c9e4"><p class="cl-d5a69d70"><span class="cl-d5a3616e">keras</span></p></td><td class="cl-d5a6c9e4"><p class="cl-d5a69d70"><span class="cl-d5a3616e">regression</span></p></td><td class="cl-d5a6c9e4"><p class="cl-d5a69d70"><span class="cl-d5a3616e">mlp</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d5a6c9e4"><p class="cl-d5a69d70"><span class="cl-d5a3616e">nnet</span></p></td><td class="cl-d5a6c9e4"><p class="cl-d5a69d70"><span class="cl-d5a3616e">classification</span></p></td><td class="cl-d5a6c9e4"><p class="cl-d5a69d70"><span class="cl-d5a3616e">mlp</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d5a6c9e4"><p class="cl-d5a69d70"><span class="cl-d5a3616e">nnet</span></p></td><td class="cl-d5a6c9e4"><p class="cl-d5a69d70"><span class="cl-d5a3616e">regression</span></p></td><td class="cl-d5a6c9e4"><p class="cl-d5a69d70"><span class="cl-d5a3616e">mlp</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d5a6c9e4"><p class="cl-d5a69d70"><span class="cl-d5a3616e">brulee</span></p></td><td class="cl-d5a6c9e4"><p class="cl-d5a69d70"><span class="cl-d5a3616e">classification</span></p></td><td class="cl-d5a6c9e4"><p class="cl-d5a69d70"><span class="cl-d5a3616e">mlp</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d5a6c9e4"><p class="cl-d5a69d70"><span class="cl-d5a3616e">brulee</span></p></td><td class="cl-d5a6c9e4"><p class="cl-d5a69d70"><span class="cl-d5a3616e">regression</span></p></td><td class="cl-d5a6c9e4"><p class="cl-d5a69d70"><span class="cl-d5a3616e">mlp</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d5a6c9e4"><p class="cl-d5a69d70"><span class="cl-d5a3616e">brulee_two_layer</span></p></td><td class="cl-d5a6c9e4"><p class="cl-d5a69d70"><span class="cl-d5a3616e">classification</span></p></td><td class="cl-d5a6c9e4"><p class="cl-d5a69d70"><span class="cl-d5a3616e">mlp</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d5a6c9e5"><p class="cl-d5a69d70"><span class="cl-d5a3616e">brulee_two_layer</span></p></td><td class="cl-d5a6c9e5"><p class="cl-d5a69d70"><span class="cl-d5a3616e">regression</span></p></td><td class="cl-d5a6c9e5"><p class="cl-d5a69d70"><span class="cl-d5a3616e">mlp</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>NN Example</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>nn_model <span class="ot">&lt;-</span> <span class="fu">mlp</span>(<span class="at">hidden_units =</span> <span class="dv">5</span>, <span class="at">penalty =</span> <span class="fl">0.01</span>) <span class="sc">|&gt;</span> </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"nnet"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">workflow</span>() <span class="sc">|&gt;</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(forested_recipe) <span class="sc">|&gt;</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(nn_model) <span class="sc">|&gt;</span> </span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(<span class="at">resample =</span> forested_folds) <span class="sc">|&gt;</span> </span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 Ã— 6
  .metric     .estimator  mean     n std_err .config             
  &lt;chr&gt;       &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
1 accuracy    binary     0.908    10 0.00462 Preprocessor1_Model1
2 brier_class binary     0.118    10 0.00139 Preprocessor1_Model1
3 roc_auc     binary     0.965    10 0.00211 Preprocessor1_Model1</code></pre>
</div>
</div>
<section id="conclusion-5" class="level4">
<h4 class="anchored" data-anchor-id="conclusion-5">Conclusion</h4>
<p>Neural Networks are a powerful tool for solving complex problems in various domains. While they require significant computational resources, proper training and regularization techniques can make them highly effective for predictive modeling. Understanding Neural Networks within the torch framework allows for practical applications in data science and environmental modeling.</p>
</section>
</section>
</section>
<section id="wrap-up" class="level2">
<h2 class="anchored" data-anchor-id="wrap-up">Wrap-up</h2>
<p>Lets combine all the models and evaluate their performance using cross-validation. * We learned about cross-validation last Monday and its importance in evaluating model performance. * We will use a workflow set (seen last Wednesday) to fit multiple models at once and compare their performance. * Remember, we have not implmented any hyperparameter tuning yet, so these are just base models.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>forested_folds <span class="ot">&lt;-</span>  <span class="fu">vfold_cv</span>(forested_train, <span class="at">v =</span> <span class="dv">10</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>wf <span class="ot">&lt;-</span>  <span class="fu">workflow_set</span>(<span class="fu">list</span>(forested_recipe), </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">list</span>(log_model, </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>                       dt_model, </span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>                       rf_model, </span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>                       b_model, </span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>                       svm_model, </span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>                       nn_model)) <span class="sc">|&gt;</span> </span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a> <span class="fu">workflow_map</span>(<span class="st">'fit_resamples'</span>, <span class="at">resamples =</span> forested_folds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-performance-comparision" class="level2">
<h2 class="anchored" data-anchor-id="model-performance-comparision">Model Performance Comparision</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(wf) <span class="sc">+</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>(<span class="dv">18</span>) <span class="sc">+</span> </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'bottom'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="17-exercise_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="model-evaluation" class="level2">
<h2 class="anchored" data-anchor-id="model-evaluation">Model Evaluation</h2>
<p>Understanding the boost model provided the best performance out of the box we can (1) select that model (2)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>final_fit <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">|&gt;</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(forested_recipe) <span class="sc">|&gt;</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Selected Model</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(b_model) <span class="sc">|&gt;</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Trained with full training dataset</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> forested_train) <span class="sc">|&gt;</span> </span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Validated against hold out data</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>(<span class="at">new_data =</span> forested_test)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="fu">metrics</span>(final_fit,  <span class="at">truth =</span> forested, <span class="at">estimate =</span> .pred_class) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 Ã— 3
  .metric  .estimator .estimate
  &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
1 accuracy binary         0.917
2 kap      binary         0.833</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">conf_mat</span>(final_fit, <span class="at">truth =</span> forested, <span class="at">estimate =</span> .pred_class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Truth
Prediction Yes  No
       Yes 910  86
       No   61 720</code></pre>
</div>
</div>
</section>
<section id="assignment" class="level2">
<h2 class="anchored" data-anchor-id="assignment">Assignment</h2>
<p><a href="https://labelyourdata.com/articles/how-to-choose-a-machine-learning-algorithm">Article on Machine Learning Selection</a></p>
<p><a href="https://www.tidymodels.org/find/parsnip/">Exploring Modes in the Parsnip Packages</a></p>
</section>
</section>
<section id="in-a-few-sentences-submit-to-canvas-describe-why-you-think-the-xgboost-model-worked-best-for-our-problem" class="level1">
<h1>In a few sentences (submit to Canvas) describe why you think the XGboost model worked best for our problem</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#?forested</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visdat)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(forested)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7107</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(forested)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [7,107 Ã— 19] (S3: tbl_df/tbl/data.frame)
 $ forested        : Factor w/ 2 levels "Yes","No": 1 1 2 1 1 1 1 1 1 1 ...
 $ year            : num [1:7107] 2005 2005 2005 2005 2005 ...
 $ elevation       : num [1:7107] 881 113 164 299 806 736 636 224 52 2240 ...
 $ eastness        : num [1:7107] 90 -25 -84 93 47 -27 -48 -65 -62 -67 ...
 $ northness       : num [1:7107] 43 96 53 34 -88 -96 87 -75 78 -74 ...
 $ roughness       : num [1:7107] 63 30 13 6 35 53 3 9 42 99 ...
 $ tree_no_tree    : Factor w/ 2 levels "Tree","No tree": 1 1 1 2 1 1 2 1 1 2 ...
 $ dew_temp        : num [1:7107] 0.04 6.4 6.06 4.43 1.06 1.35 1.42 6.39 6.5 -5.63 ...
 $ precip_annual   : num [1:7107] 466 1710 1297 2545 609 ...
 $ temp_annual_mean: num [1:7107] 6.42 10.64 10.07 9.86 7.72 ...
 $ temp_annual_min : num [1:7107] -8.32 1.4 0.19 -1.2 -5.98 ...
 $ temp_annual_max : num [1:7107] 12.9 15.8 14.4 15.8 13.8 ...
 $ temp_january_min: num [1:7107] -0.08 5.44 5.72 3.95 1.6 1.12 0.99 5.54 6.2 -4.54 ...
 $ vapor_min       : num [1:7107] 78 34 49 67 114 67 67 31 60 79 ...
 $ vapor_max       : num [1:7107] 1194 938 754 1164 1254 ...
 $ canopy_cover    : num [1:7107] 50 79 47 42 59 36 14 27 82 12 ...
 $ lon             : num [1:7107] -119 -123 -122 -122 -118 ...
 $ lat             : num [1:7107] 48.7 47.1 48.8 45.8 48.1 ...
 $ land_type       : Factor w/ 3 levels "Barren","Non-tree vegetation",..: 3 3 3 3 3 3 2 2 3 2 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vis_dat</span>(forested)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="17-exercise_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The XGboost model worked best because itâ€™s a collection of smaller decision trees that works well with forest data and superivsed learning. The forested dataset has 7107 rows, so itâ€™s not ideal for a random forest with does better with large datasets nor with neural networks or svm. Since there are no NA values, xgboost does a good job. There were multiple predictors influencing tree or no tree which could have had varying amounts of linearity, so linear regression was too simplistic. Likewise, logistic regression assumes a linear decision boundary. SVM needed more parameter tuning, while neural networks typically more data. Boost models analyze importance of features, which is relevant to forest cover. Also, xgboost both predicts and classifies, both of which are needed for large forested datasets.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>